# 1章

ドメインオブジェクト

→業務などの関心ごとに対応したクラスをドメインオブジェクトという

→ex: 送料クラス は 送料 に関することをやっている

プログラムの変更が楽になる書き方

1. 変数や関数にわかりやすい名前を使う
2. 空白行などを挿入して段落ごとに分ける
3. 目的ごとのローカル変数を使用する

    送料や税込の金額を格納する変数など用途ごとに分ける、グローバル変数を使用しない(破壊的代入)
    
4. メソッドとして独立させる
    
    2.と3.で段落ごとに独立性が高くなるのでメソッドに変化させてやる→影響範囲を閉じ込める
    
5. 異なるクラスの同じような処理をする関数の処理
    
    参照関係ならば参照される側にメソッドを定義し、参照する側で呼ぶ
    
    参照関係ではないならば新たに新しいクラスを作成しそこから呼び出す
    
6. 値を扱うだけのクラスを作る(値オブジェクト)
    
    クラス内で本来必要としない値などをフィルタリングする
    
7. 値が異なれば別のオブジェクトにする
    
    値が代入されるたびに別のオブジェクトを作成する(内部のインスタンス変数を変化させない)(完全コンストラクタ)
    
8. リストや配列の操作はクラス内に閉じ込める
9. クラス内に閉じ込めたリストや配列を取得する時は新しいコレクションオブジェクトを返すようにする
    
    ex: return new Customers(customers); など
    

# 2章

判断処理のロジックはメソッドに独立させる

else句を書かない

→早期リターンにする(ガード節という)

例

```js
function fee(){
	if(isBaby()) return babyFee()
	if(isChild()) return childFee()
	// 条件外else的なやつは最後にreturnする
	return adultFee()
}
```

interfaceは別々の方を同じ型として使えるようにする仕組み

例

```jsx
class AbultFee
fee()
label()

class ChildFee
fee()
label()

// AdultFeeとChildFeeは処理は同じだけど型が違う
interface Fee
fee()
label()

class AdultFee implements Fee
class ChildFee implements Fee
```

こうすることで使う側はAdultFeクラスなのかChildFeeクラスなのかを意識しなくて良くなる

どのインスタンスがあるかどうかを区別するにはMapやenumを使用するとわかりやすくなる

審査中や申請済みなどの状態をenumで管理する

# 3章

業務ロジックとデータを同じクラスに置く(domainオブジェクト)

メソッドは必ずインスタンス変数を使用する

→逆に使用しない場合は置き場所を検討する必要がある

メソッドを小さく分けて独立させる

クラスがデカくなってきたら関連性の強いデータとメソッドを別のクラスとして抽出する

packageが使える

# 4章
まとめ中

# 5章

三層+ドメインモデル

プレゼンテーション層(IOやrouting、画面など)

アプリケーション層(ドメインオブジェクトに判断加工計算を依頼する)

データソース層(DBなど)

サービスクラスの設計

業務ロジックはサービスクラスに書かない(サービスクラスで判断加工計算しない)

画面の複雑さをサービスクラスに持ち込まない

データベースの入出力の都合をサービスクラスから独立させる

サービスクラスを分けるときは登録系と参照系で分けると分けやすい

使う側と使われる側で約束事をする

nullを渡さないnullを返さない

状態に依存する場合は使う側が事前に確認する

約束を守った上で異常が発生した場合は例外を投げる

# 6章

テーブル名やカラム名に省略形を使用しない

適切なデータ型を使用する

制約を必ず使用する(ex: NOT NULL制約、一意制約、外部キー制約)

カラムに値が入らない場合はそのカラムを別のカラムにする

徹底的に重複をなくす

外部キー制約でテーブル間の関係を保証する

記録のタイミングが異なるデータはテーブルを分ける

→NULLが混入するのを防ぐ

記録の変更を禁止する

変更を記録する(論理削除)

カラムの追加はテーブルを追加する

→追加したテーブルと元のテーブルは外部キー制約で繋がっている

状態の記録ではなく起こったことの記録

残高であれば入出金記録から残高を導出することが可能

状態の記録が必要なニーズがあるときはことの記録のたびに状態雨を更新するテーブルを用意する

状態の記録はUPDATEではなくDELETE+INSERTで使用する

イベントソーシング

ドメインオブジェクトは業務の関心ごと、テーブルは事実の記録の役割があるので混ぜない

# 7章
まとめ中
# 8章
まとめ中
# 9章
まだ読んでいない
# 10章
まだ読んでない